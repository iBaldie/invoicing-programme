0 REM COPYRIGHT M.J.BALDWIN 1986
1 BORDER 5
2 POKE 23609, 50
3 LET ON=1 : LET OF=0
6 IF I$="L" THEN DIM A$(1) : MERGE *"m";1; "od"
10 POKE CAP,8
15 CLS
16 PLOT 0,152: DRAW 255,0:  PLOT 0,143: DRAW 255,0
17 GO SUB 700
20 PRINT AT 1,2;  BRIGHT ON; "* TRADE PRINTING COMPANY *"
22 PRINT AT 3,0; PAPER 5;  "             "; PAPER 7; BRIGHT ON; "*  INVOICING  *"; BRIGHT OF; PAPER 5; "           "
24 PRINT AT 5,4; BRIGHT ON; "1"; BRIGHT OF; ". PREPARE AN INVOICE."
26 PRINT AT 8,4; BRIGHT ON; "2"; BRIGHT OF; ". PRINT ANOTHER COPY."
28 PRINT AT 11,4; BRIGHT ON; "3"; BRIGHT OF;  ". CUSTOMER FILES."
30 PRINT AT 14,4; BRIGHT ON; "4"; BRIGHT OF; ".  SAVE PROGRAMME."
32 PRINT AT 17,4; BRIGHT ON; "5"; BRIGHT OF; ".  ENTER PAID ACCOUNT."
34 PRINT AT 20,4; BRIGHT ON; "6"; BRIGHT OF; ".  CLEAR MEMORY."
36 BEEP .1,15
38 PAUSE OF
40 LET I$=INKEY$
42 IF INKEY$<> " " THEN GO TO 42
44 IF I$="1" THEN GO TO 1000
46 IF I$="2" THEN GO TO 1670
48 IF I$="3" THEN GO TO 3000
50  IF I$="4" THEN GO TO 9610
52 IF I$="5" THEN GO TO 4000
54 IF I$="6" THEN GO TO 8000
55 IF I$="M" THEN GO TO 9800
56 IF I$="L" THEN GO TO 6
100 GO TO 10
200 PRINT AT 1,5; PAPER 7; BRIGHT ON; "ANY KEY FOR NEXT PAGE": PAUSE OF: RETURN
300 IF C$="0" THEN GO TO 365
320 LET SX=VAL C$: LET V$=" "
325 IF SX=INT SX THEN LET V$=".00" : GO TO 350
340 IF CODE (C$(LEN C$-1))=46 THEN LET V$="0"
350 LET C$=C$+V$
360 RETURN
365 IF C$="0" THEN LET C$="0.00"
370 RETURN
400 IF K$="0" THEN GO TO 452
410 LET SX=VAL K$: LET V$=" "
420 IF SX=INT SX THEN LET V$=".00": GO TO 450
440 IF CODE (K$(LEN K$-1))=46 THEN LET V$="0"
450 LET K$=K$+V$
451 RETURN
452 IF K$="0" THEN LET K$="0.00"
454 RETURN
460 IF G$="0" THEN GO TO 488
462 LET SX=VAL G$: LET V$=" "
464 IF SX=INT SX THEN LET V$=".00": GO TO 485
466 IF CODE (G$(LEN G$-1))=46 THEN LET V$="0"
485 LET G$=G$+V$
486 RETURN
488 IF G$="0" THEN LET G$="0.00"
490 RETURN
500 PRINT AT 1,0; M$: PRINT AT 21,0; BRIGHT ON; "  Press P to print or M for menu  ": PRINT AT 1,12; PAPER 7; BRIGHT ON; FLASH ON; "P"; BRIGHT OF; FLASH OF; PAPER 5; "  or  "; PAPER 7; BRIGHT ON; FLASH ON; "M": BEEP .1,15: PAUSE 0
510 LET P$=INKEY$: IF P$<>"P" AND P$<>"M" THEN GO TO 500
520 RETURN
550 IF INKEY$<>"" THEN GO TO 550
560 PRINT AT 0,0; FLASH ON; BRIGHT ON; PAPER 7; "PRESS KEY E IF YOU HAVE MADE AN    ERROR OR ENTER TO CONTINUE.    "
570 IF INKEY$="" THEN GO TO 570
580 LET I$=INKEY$
590 RETURN
600 BEEP .2,15: BEEP .2,8: PRINT AT 21,0; BRIGHT ON ; "Line is too long, please re-type": PAUSE 80: PRINT AT 21,0; M$
610 RETURN
700 PLOT 0,0: DRAW 255,0: DRAW 0,175: DRAW -255,0: DRAW0,-175
701 RETURN
800 INPUT "Enter Percent Discount:  "; PER
810 LET DIS=(TOT*PER)/100: LET DIS=INT (DIS*100+0.5)/100
820 LET TOT1=TOT-DIS
830 RETURN
850 INPUT (" If VAT rate  "; PER1;"% press ENTER "); LINE H$: IF CODE H$=0 THEN GO TO 870
860 LET PER1=VAL H$
870 LET VAT=(TOT1*PER1)/100: LET VAT=INT (VAT*100+0.5)/100
880 RETURN
920 PRINT AT 1,0; M$: PRINT AT 1,12; FLASH ON; BRIGHT ON; PAPER 7; "Y"; BRIGHT OF; FLASH OF; PAPER 5; " or "; PAPER 7; BRIGHT ON; FLASH ON; "N": BEEP .1,15: PAUSE 0: IF INKEY$<>"Y" AND INKEY$<>"N" THEN GO TO 900
930 RETURN
1000 REM **INVOICE**
1010 LET W$="MJB"
1020 LET TOT=0: LET TOT1=0
1030 CLS: GO SUB 700: POKE CAP,0: BEEP .1,15
1040 PRINT AT 0,0; BRIGHT ON; "INVOICE NO:": INPUT BRIGHT ON; PAPER 7; "ENTER NEXT INVOICE NO:"; BRIGHT OF; PAPER 5; " "; LINE H$: IF CODE H$=0 THEN GO TO 10
1050 LET IN=VAL H$: FOR P=1 TO TAT-1: IF IN=C(P,2) THEN PRINT AT 21,2; INK 2; FLASH ON; "ERROR NUMBER ALREADY ENTERED": PAUSE 10: BEEP .2,15: BEEP .3,8: PAUSE 80: CLS: GO TO 1000
1060 NEXT P: PRINT AT 0,0; BRIGHT ON; "INVOICE NO: "; BRIGHT OF; " "; BRIGHT ON; IN
1070 PRINT " "
1080 PRINT AT 21,0; BRIGHT ON; "ENTER Customers Name:     *         ": INPUT LINE R$: IF CODE R$=0 THEN GO TO 10
1085 IF LEN R$>25 THEN GO SUB 600: GO TO 1080
1090 PRINT B$(1): PRINT AT 17,10; FLASH ON; BRIGHT ON; INK 2; "NOT ON FILE": PRINT AT 21,0; M$: BEEP .2,15: BEEP .2,8: PAUSE 20: PRINT AT 19,1; "ENTER to continue or any key": PRINT ‘ TAB 7; "to return to menu": BEEP .2,15: BEEP .2,8: PAUSE 0: IF CODE INKEY$<>13 THEN GO TO 10
1102 PRINT AT 17,0; M$: PRINT ‘; M$
1104 FOR P=2 TO 6
1106 PRINT AT 21,0; BRIGHT ON; "ENTER Line ";P-1; " of address.*        ": POKE CAP,0: INPUT LINE D$
1108 IF LEN D$>25 THEN GO SUB 600: GO TO 1106
1110 LET B$(P)=D$: PRINT AT P+2,1; B$(P): NEXT P
1120 IF R$="TPC" THEN PRINT AT 0,18; BRIGHT ON; "Account No:"; BRIGHT OF; " "; BRIGHT ON; Y
1130 PRINT AT 21,0; BRIGHT ON; "Enter clients order No. or Ref.": INPUT LINE B$(7)
1140 PRINT AT 10,1; "REF:  "; B$(7)
1150 PRINT AT 21,0; BRIGHT ON; "Enter Date:"
1160 IF E$(2)<> "         " THEN PRINT AT 21,11; BRIGHT ON; "  (If  ";E$(2);") ENTER"
1170 INPUT "         "; LINE E$(1): IF E$(1)="         " THEN LET E$(1)=E$(2)
1180 LET E$(2)=E$(1): PRINT AT 12,1;"DATE:  "; E$(1)
1190 POKE CAP,8: PRINT AT 21,0; M$: GO SUB 550
1200 IF J$="E" THEN GO TO 10
1202 CLS: LET X=2
1220 DIM A$(9,64)
1230 FOR D=1 TO 9
1240 PRINT AT 0,1; BRIGHT ON; "ENTER INVOICE DETAILS LINE  "; BRIGHT OF; " "; TAB 29; BRIGHT ON; D
1250 POKE CAP,0: INPUT LINE D$
1260 IF LEN D$>64 THEN GO SUB 600: GO TO 1240
1270 PRINT AT 0+X,0; D$
1280 LET A$(D)=D$: LET X=X+2: NEXT D
1290 POKE CAP,8: GO SUB 550: IF J$="E" THEN GO TO 1202
1295 CLS: GO SUB 700
1300 PRINT AT 0,0; BRIGHT ON; "INVOICE NO: "; BRIGHT OF; " "; BRIGHT ON; IN: IF R$="TPC" THEN PRINT AT 0,18; BRIGHT ON; "Account No:"; BRIGHT OF; "  "; BRIGHT ON; Y
1310 PRINT "": FOR P=1 TO 6
1320 PRINT AT P+1,1; B$(P): NEXT P
1330 INPUT BRIGHT ON; PAPER 7; "ENTER JOB COST  "; PAPER 5; BRIGHT OF; "  "; TOT
1340 PRINT AT11,1; "JOB COST ........... £ "; TAB 28-LEN STR$ INT TOT; TOT
1360 LET TOT=TOT: LET TOT1=TOT
1370 PRINT AT 21,0; BRIGHT ON; "        Is there any discount ?        "
1380 GO SUB 900: LET F$= INKEY$: IF F$="Y" AND F$="N" THEN GO TO 1380
1390 IF F$="Y" THEN GO SUB 800
1400 IF F$="Y" THEN PRINT AT 12,1; "DISCOUNT AT  "; PER; " % ... £"; TAB 28-LEN STR$ INT DIS; DIS
1410 IF F$="Y" THEN PRINT AT 13,1; "TOTAL LESS "; PER; " % .... £"; TAB28-LEN STR$ INT TOT1; TOT1
1420 PRINT AT 21,0; BRIGHT ON; "   ENTER V.A.T. %  (0 or 15) "
1430 GO SUB 850
1440 PRINT AT 14,1; "VAT AT  "; PER1; "% ......... £"; TAB 28-LEN STR$ INT VAT; VAT
1450 PRINT AT 17,1; "TOTAL .............. £"; TAB 28-LEN STR$ INT (TOT1+VAT); TOT1+VAT
1452 PRINT AT 21,0; M$: GO SUB 550: IF J$="E" THEN PRINT AT 11,20; "             ": GO TO 1295
1454 PRINT AT 1,0; M$: PRINT AT0,0; M$
1460 GO SUB 4500
1480 GO SUB 500
1490 IF P$= "M" THEN GO TO 10
1510 REM **INV PRINT**
1520 LET A=1: LET B=2: LET C=3: LET D=4: LET E=5: LET F=6: LET G=7
1530 LPRINT: LPRINT: LPRINT: LPRINT TAB 8; B$(A); TAB 53; "INVOICE No:   "; IN: LPRINT TAB 8;B$(B): LPRINT TAB 8;B$(C): LPRINT TAB 8;B$(D); TAB 53; "Date:   "; E$(1): LPRINT TAB 8;B$(E): LPRINT TAB 8;B$ (F); TAB 53; "Ref:  "; B$(G)
1540 LPRINT : LPRINT : IF R$="TPC" THEN LPRINT TAB 31; "Account No.  ";Y
1550 LPRINT : LPRINT : LPRINT
1560 FOR D=1 TO 9: LPRINT TAB 7; A$(D): NEXT D
1570 LPRINT : LPRINT : LPRINT
1580 LET C$=STR$ (TOT): GO SUB 300
1590 LPRINT TAB 41; "TOTAL"; TAB 71-LEN C$; C$
1600 IF F$="Y" THEN LET C$= STR$ (DIS): GO SUB 300: LPRINT TAB 41; "DISCOUNT AT  "; PER; "%"; TAB 71-LEN C$; C$
1610 IF F$="Y" THEN LET C$= STR$ (TOT1): GO SUB 300: LPRINT TAB 41; "TOTAL LESS DISCOUNT"; TAB 71-LEN C$; C$
1620 LET C$= STR$ (VAT): GO SUB 300
1630 LPRINT TAB 41; "V.A.T. AT "; PER1; "%"; TAB 71-LEN C$;C$
1650 PAUSE 100: CLS: GO TO 10
1670 CLS: GO SUB 700: PRINT AT 4,3; BRIGHT ON; INK ON; "* TRADE PRINTING COMPANY *"
1680 PRINT AT 7,5; BRIGHT ON; "TO PRINT ANOTHER COPY"; PRINT AT 9,7; BRIGHT ON; "OF LAST INVOICE"
1690 PRINT AT 14,2; INK 2; FLASH ON; "Check that printer is loaded": GO SUB 500
1700 IF P$= "M" THEN GO TO 10
1710 IF P$= "P" THEN GO TO 1500
1720 GO TO 10
2500 CLS: GO SUB 700: PRINT AT 1,5; BRIGHT ON; "ENTERING NEW ACCOUNT"
2510 IF S1>70 THEN PRINT AT 10,9; BRIGHT ON; FLASH ON; "FILE IS FULL": PAUSE 100: GO TO 10
2520 POKE CAP,OF: PRINT AT 21,0; BRIGHT ON; "Enter Clients name:       *      ": INPUT LINE R$: POKE CAP,8: IF CODE R$=0 THEN GO TO 3000
2525 IF LEN R$>25 THEN GO SUB 600: GO TO 2520
2530 FOR K=1 TO S1-1: IF R$=S$(K,1, TO LEN R$) THEN PRINT AT 12,3; BRIGHT ON; FLASH ON; "NAME IS ALREADY IN MEMORY": BEEP .2,15: PAUSE 10: BEEP .2,15: BEEP .3,8: PAUSE 20: GO TO 3000
2540 NEXT K
2550 PRINT AT 4,5; R$
2551 FOR K=2 TO 6
2552 PRINT AT21,0; BRIGHT ON; "ENTER Line "; K-1; " of address.*        ": POKE CAP,OF: INPUT LINE D$
2554 IF LEN D$> 25 THEN GO SUB 600: GO TO 2552
2556 LET S$(S1,K)= D$: PRINT AT K+3,5; S$ (S1,K): NEXT K
2560 POKE CAP,8: PRINT AT 21,0; M$: GO SUB 550
2570 IF J$="E" THEN GO TO 3000
2580 LET S1=S1+1: GO TO 3100   REM ( Not sure about this line as corrupt on print out )
2582 IF P$=M$ THEN THEN GO TO 3300
3000 CLS : LET Q$=""
3001 GO SUB 700
3010 PRINT AT 3,1; BRIGHT ON; "CUSTOMER FILES"
3020 PRINT AT 3,1; BRIGHT ON; "1"; BRIGHT OF; ".  SEARCH FOR CLIENT BY": PRINT AT 4,4; "ACCOUNT NUMBER."
3030 PRINT AT 6,1; BRIGHT ON; "2"; BRIGHT OF; ".  SEARCH FOR A CLIENT BY NAME."
3040 PRINT AT 8,1; BRIGHT ON; "3"; BRIGHT OF; ".  SCAN NAMES AND ADDRESSES."
3050 PRINT AT 10,1; BRIGHT ON; "4"; BRIGHT OF; ".  CURRENT MONTH TOTAL."
3060 PRINT AT 12,1; BRIGHT ON; "5"; BRIGHT OF; ".  PRINT NAMES AND ACC. NO’S."
3070 PRINT AT 14,1; BRIGHT ON; "6"; BRIGHT OF; ".  ENTER NEW ACCOUNT."
3075 PRINT AT 16,1; BRIGHT ON; "7"; BRIGHT OF; ".  PRINT TOTAL BALANCE DUE."
3077 PRINT AT 18,1; BRIGHT ON; "8"; BRIGHT OF; ".  PRINT 90-30 DAY BALANCE."
3080 PRINT AT 21,5; BRIGHT ON; "PRESS ENTER TO RETURN"
3090 BEEP .1,15
3100 PAUSE OF
3110 LET I$= INKEY$
3120 IF I$="1" THEN GO TO 3150
3122 IF I$="2" THEN GO TO 3170
3124 IF I$="3" THEN GO TO 3300
3126 IF I$="4" THEN GO TO 5000
3128 IF I$="5" THEN GO TO 3190
3130 IF I$="6" THEN GO TO 2500
3131 IF I$="7" THEN GO TO 7300
3132 IF I$="8" THEN GO TO 7400
3134 GO TO 3000
3150 PRINT AT 21,3; BRIGHT ON; "        ENTER Account Number     ": INPUT " No:  "; LINE H$: IF H$="" THEN GO TO 3000
3155 LET K=VAL H$: IF K>S1 OR K<1 THEN GO TO 3172
3160 LET Q$="*": CLS: GO TO 3302
3170 LET Q$="*": POKE CAP,OF; PRINT AT 21,3; BRIGHT ON; "    ENTER Customer name:": INPUT "    "; LINE J$: IF J$="" THEN GO TO 3000
3171 POKE CAP,8: FOR K=1 TO S1: IF J$=S$(K,1, TO LEN J$) THEN CLS: GO TO 3302
3172 NEXT K: PRINT AT 21,2; BRIGHT ON; FLASH ON; "NOT ON FILE / WRONG SPELLING": PAUSE 10: BEEP .2,15: BEEP .3,8: PAUSE 10: BEEP .2,15: BEEP .3,8: PRINT AT 21,0; M$: LET Q$="": GO TO 3000
3174 GO TO 3000
3180 LPRINT "  COMPANY          INVOICE NO        DATE        TOTAL"
3182 LPRINT : LET YZ=0: FOR K=1 TO TAT-1: LET TP=C(K,3): LET C$=STR$ (TP): GO SUB 300
3184 LPRINT TAB 1; S$(K,1); TAB 29; C(K,2); TAB 40; O$(K); TAB 68-LEN C$; C$: LET YZ=YZ+C(K,3): NEXT K: LET TP=YZ: LET C$=STR$ (TP): GO SUB 300: LPRINT: LPRINT TAB 43; "GRAND TOTAL:"; TAB 68-LEN C$; C$
3186 GO TO 3000
3190 LET X=1: CLS: GO SUB 700: FOR K=1 TO S1-1: FOR P=1 TO 1: PRINT AT X,1; S$(K,P); "    "; K: IF K=20 OR K=40 OR K=60 THEN PRINT AT 1,5; PAPER 7; BRIGHT ON; "ANY KEY FOR NEXT PAGE": PAUSE 0: CLS: GO SUB 700: LET X=1: NEXT K
3191 LET X=X+1: NEXT K
3192 PRINT: PRINT: GO SUB 500
3194 IF P$="P" THEN GO TO 3200
3196 IF P$="M" THEN GO TO 3000
3198 GO TO 3000
3200 LPRINT "CUSTOMER "; TAB 37; "ACC.NO. ": LPRINT: FOR K=1 TO S1-1: FOR P=1 TO 1
3202 LPRINT S$(K,P), K: NEXT K
3204 GO TO 3000
3300 CLS: FOR K=1 TO S1-1
3302 GO SUB 700: PLOT 8,115: DRAW 242,0: DRAW 0,55: DRAW -242,0: DRAW 0,-55
3306 FOR P=1 TO 6: PRINT AT P,5; INK ON; S$(K,P): PRINT AT 1,2; BRIGHT ON; K
3308 NEXT P
3309 IF I$="N" THEN GO TO 3330
3320 PRINT AT 8,2; BRIGHT ON; "A"; BRIGHT OF; "    ALTER DETAILS."
3322 PRINT AT 10,2; BRIGHT ON; "L"; BRIGHT OF; "    PRINT LABEL."
3324 PRINT AT 12,2; BRIGHT ON; "M"; BRIGHT OF; "    RETURN TO FILE MENU."
3325 PRINT AT 4,2; BRIGHT ON; "T"; BRIGHT OF; "    PRINT OUT TOTAL FOR MONTH."
3326 PRINT AT 16,2; BRIGHT ON; "S"; BRIGHT OF; "    STATEMENT OF ACCOUNT."
3327 PRINT AT 18,2; BRIGHT ON; "B"; BRIGHT OF; "    ACCOUNT BALANCE."
3328 IF Q$= "" THEN PRINT AT 20,2; BRIGHT ON; "N"; BRIGHT OF; "       FOR NEXT ACCOUNT."
3329 IF Q$="*" THEN PRINT AT 20,3; BRIGHT ON; "   PRESS ENTER FOR MAIN MENU"
3331 BEEP .1,15: PAUSE OF: LET I$=INKEY$: IF CODE I$=13 THEN GO TO 10
3332 IF Q$="*" AND I$="N" THEN GO TO 3000
3334 IF I$="N" THEN NEXT K: GO TO 3000
3336 IF I$="A" THEN GO TO 3350
3337 IF I$="T" THEN GO TO 7000
3338 IF I$="L" THEN GO TO 3354
3340 IF I$="M" THEN GO TO 3000
3342 IF I$="S" THEN GO TO 3530
3343 IF I$="B" THEN GO TO 7100
3344 GO TO 3000
3350 FOR P=1 TO 6: PRINT AT P,2; BRIGHT ON; P; BRIGHT OF; "  ": NEXT P: PRINT AT 20,0; BRIGHT ON; " ENTER Line No. you want to alter": INPUT "        Line No:  " LINE H$: IF ((CODE H$) <49) OR ((CODE H$) >54) THEN CLS: GO TO 3301
3352 LET LIN=VAL H$: POKE CAP,OF: PRINT AT 20,1; BRIGHT ON; "        ENTER New details        ": INPUT "     "; LINE s$(K,LIN): POKE CAP,8: LET I$="1": CLS: GO TO 3301
3354 PRINT AT 20,1; M$: GO SUB 500
3356 IF P$="M" THEN CLS: GO TO 3302
3358 IF P$="P" THEN FOR A=1 TO 6: LPRINT S$(K,A): NEXT A: CLS: GO TO 3302
3500 FOR Y=1 TO S1-1
3510 IF R$=S$(Y,1 TO LEN R$) THEN FOR P=1 TO 6: LET B$(P)=S$(Y,P): PRINT AT P+1,1; S$(Y,P): NEXT P: LET R$="TPC": GO TO 1120
3520 NEXT Y: RETURN
3530 CLS: GO SUB 700: FOR P=1 TO 1: PRINT AT 0,0; BRIGHT ON; S$(K,P); BRIGHT OF; " "; BRIGHT ON; K: PRINT ""
3532 LET X=2: LET YT=0: LET LM=0: LET LB=0
3534 FOR P=1 TO TAT-1: IF C(P,1)=K THEN LET CX=1: LET FA=C(P,3): LET MJ=Q(P,1): LET MB=FA-MJ: LET C$=STR$ (FA): GO SUB 300: LET K$=STR$ (MB): GO SUB 400: LET G$=STR$(MJ): GO SUB 460: PRINT AT X,1; C(P,2); TAB 13-LEN G$;G$; TAB 31-LEN C$;C$: LET YT=YT+C(P,3): LET LM=LM+MB: LET LB=LB+MJ: LET X=X+1
3536 NEXT P: PRINT AT X,5; "—————————————": LET K$=STR$ (LM): GO SUB 400: LET G$=STR$ (LB): GO SUB 460: LET C$=STR$ (YT): GO SUB 300: PRINT AT X+1,1; "Tot:"; TAB 13- LEN K$; K$; TAB 22-LEN G$; G$; TAB 31-LEN C$; C$
3538 PRINT AT 21,0; BRIGHT ON; "Do you want to prepare statement ?": GO SUB 900
3540 LET F$= INKEY$
3541 IF F$="N" THEN CLS: GO TO 3302
3542 PRINT AT 21,0; BRIGHT ON; "    Do you want to see Balance ?    ": GO SUB 900
3546 LET F$= INKEY$: IF F$="Y" THEN GO TO 7100
3548 IF F$="N" THEN GO TO 3600
3600 PRINT AT 20,0; M$: PRINT AT 21,0; BRIGHT ON; "ENTER Date:"
3602 IF E$(2) <> "           " THEN PRINT AT 21,11; BRIGHT ON;    (If ";E$(2);")   ENTER
3604 INPUT "  "; LINE E$(1): IF E$(1)="          " THEN LET E$(1)=E$(2)
3606 LET E$(2)=E$(1)
3608 GO SUB 500
3610 IF P$="P" THEN GO TO 3614
3612 IF P$="M" THEN GO TO 3302
3614 LET YT=0: LPRINT: LPRINT: LPRINT: LPRINT TAB 8; S$(K,1); TAB 55; "Date:  "; E$(1): LPRINT TAB 8; S$(K,2): LPRINT TAB 8; S$(K,3); TAB 55; "Account No:  ";K: LPRINT TAB 8; S$(K,4): LPRINT TAB 8; S$(K,5): LPRINT TAB 8; S$(K,6)
3616 LPRINT : LPRINT: LPRINT ‘ TAB 8; "Invoice no. "; TAB 36; "Date"; TAB 62; "Total"
3618 LPRINT: LPRINT
3620 LET LI=0: FOR P=1 TO TAT-1: IF C(P,1)=K THEN LET CX=1: LET FA=C(P,3): LET C$=STR$ (FA): GO SUB 300: LPRINT TAB 8; C(P,2); TAB 35; O$(P); TAB 67-LEN C$;C$; LET YT=YT+C(P,3): LET LI=LI+1
3624 NEXT P: LET C$=STR$ (YT): GO SUB 300
3625 IF LI<5 THEN LPRINT: LPRINT:LPRINT: LPRINT
3626 LPRINT ‘ TAB 39; "Current Month    :"; TAB 67-LEN C$; C$
3627 IF U(K,1) + U(K,2) + U(K3)=0 THEN GO TO 3648
3628 LET C$=STR$ (U(K,1) + U(K,2) + U(K,3)): GO SUB 300
3629 LPRINT: LPRINT TAB 39; "Overdue Balance : "; TAB 67-LEN C$; C$
3648 LET TIT=U(K,1) + U(K,2) + U(K,3) + U(K,4): LET C$=STR$ (TIT): GO SUB 300
3650 LPRINT: LPRINT TAB 39; "Total Balance   : "; TAB 67-LEN C$; C$
3700 CLS: GO TO 3000
3800 REM *END OF PRINT*
4000 CLS: PRINT AT 8,5; BRIGHT ON; "TO ENTER PAID ACCOUNT"
4001 PLOT 0,0: DRAW255,0: DRAW 0,175: DRAW -255,0: DRAW0,-175
4010 PRINT AT 14,1; "PRESS  "; BRIGHT ON; "ENTER"; BRIGHT OF; "  TO RETURN TO MENU"
4020 BEEP .1,15
4040 POKE CAP,OF: PRINT AT 20,3; BRIGHT ON; "   ENTER Customer name:    ": INPUT " "; LINE J$: IF J$="" THEN GO TO 10
4041 FOR K=1 TO S-1: IF J$=S$(K,1 TO LEN J$) THEN CLS: POKE CAP,8: GO TO 7100
4042 NEXT K
4050 NEXT K: PRINT AT 21,1; BRIGHT ON; FLASH ON; " NO RECORD OF THIS NO.  IN FILE": PAUSE 10: BEEP.2,15: BEEP.3,8: PAUSE 10: BEEP .2,15: BEEP .3,8: PAUSE 10: PRINT AT 21,0; M$: GO TO 4020
4500 IF TAT>STA THEN PRINT AT 11,8; BRIGHT ON; FLASH ON; "FILE IS FULL": PAUSE 100: RETURN
4520 PRINT AT 20,0; M$; BRIGHT ON; "        CONFIRM ADD TO ACCOUNT.        "
4525 GO SUB 900: IF INKEY$<>"Y" THEN RETURN
4530 LET C(TAT,1)=Y: LET C(TAT,2)=IN: LET O$(TAT)=E$(1): LET Q(TAT,1)=VAT: LET C(TAT,3)=TOT+VAT: IF F$="Y" THEN LET C(TAT,3)=TOT1+VAT
4535 LET U(Y,4)=U(Y,4)+C(TAT,3)
4540 LET TAT=TAT+1
4550 RETURN
5000 CLS: PRINT AT 0,5; BRIGHT ON; "CURRENT MONTH INVOICED": PRINT: LET YZ=0: FOR K=1 TO TAT-1: LET TP=C(K,3): LET C$=STR$ (TP): GO SUB 300
5010 PRINT S$(C(K,1); TAB 32-LEN C$;C$: LET YZ=YZ+C(K,3): IF K=18 OR K=36 THEN GO SUB 200: CLS: PRINT: NEXT K
5011 NEXT K: LET TP=YZ: LET C$=STR$ (TP): GO SUB 300: PRINT TAB 24; "————": PRINT TAB 8; "GRAND TOTAL:"; TAB 32-LEN C$;C$
5022 PRINT: PRINT: GO SUB 500
5030 IF P$="M" THEN GO TO 3000
5040 IF P$="P" THEN PRINT AT 21,0; BRIGHT ON; "     Enter the month of account  ": INPUT "        "; LINE Z$
5042 LET M=LEN Z$: LET M=INT (78-M) /2
5045 LPRINT TAB M;Z$
5050 LPRINT: LPRINT: LPRINT TAB5; "  COMPANY"; TAB 32; "INVOICE NO"; TAB 50; "DATE"; TAB 68; "TOTAL"
5060 LPRINT: LET YZ=0: FOR K=1 TO TAT-1: LET TP=C(K,3): LET C$=STR$ (TP): GO SUB 300
5070 LPRINT TAB 6; S$(C(K,1),1); TAB 34; C(K,2); TAB 48; O$(K); TAB 73-LEN C$;C$: LET YZ=YZ+C(K,3): NEXT K: LET TP=YZ: LET C$=STR$ (TP): GO SUB 300: LPRINT: LPRINT TAB 48; "GRAND TOTAL:"; TAB 73-LEN C$; C$
5080 GO TO 3000
7000 GO SUB 500
7002 IF P$="M" THEN CLS: GO TO 3302
7009 LET YT=0: LET LM=0: LET LB=0
7010 LPRINT: LPRINT TAB 28;S$(K,1)
7040 FOR P=1 TO TAT-1: IF C(P,1)=K THEN LET CX=1: LET FA=C(P,3): LET MJ=Q(P,1): LET MB=FA-MJ: LET C$=STR$ (FA): GO SUB 300: LET K$=STR$ (MB): GO SUB 400: LET G$=STR$ (MJ): GO SUB 460: LPRINT TAB 8; C(P,2); TAB 19; O$(P); TAB 42-LEN K$;K$; TAB 56 - LEN G$;G$; TAB 72-LEN C$;C$: LET YT=YT+C(P,3): LET LM=LM+MB: LET LB=LB+MJ
7048 NEXT P: LET C$=STR$ (YT): GO SUB 300: LET K$=STR$ (LM): GO SUB 400: LET G$=STR$ (LB): GO SUB 460: LPRINT TAB 8"—————————————————————————————": LPRINT TAB 24; "Total. :"; TAB 42-LEN K$; K$; TAB 56-LEN G$; G$; TAB 72-LEN C$; C$
7050 CLS: GO TO 3000
7060 GO TO 10
7100 CLS: PRINT AT 1,1; BRIGHT ON; S$(K,1); BRIGHT OF; "    "; BRIGHT ON; K
7101 GO SUB 700
7120 LET G$=STR$ (U(K,1)): GO SUB 460: PRINT AT 4,3; BRIGHT ON; "Overdue 90 days: "; BRIGHT OF; INK 2; TAB 30-LEN G$;G$
7130 LET G$=STR$ (U(K,2)): GO SUB 460: PRINT AT 7,3; BRIGHT ON; "Overdue 60 days: "; BRIGHT OF; INK 2; TAB 30-LEN G$;G$
7140 LET G$=STR$ (U(K,3)): GO SUB 460: PRINT AT 10,3; BRIGHT ON; "Overdue 30 days: "; BRIGHT OF; INK 2; TAB 30-LEN G$;G$
7150 LET G$=STR$ (U(K,4)): GO SUB 460: PRINT AT 13,3; BRIGHT ON; " Current account: "; BRIGHT OF; "  "; TAB 30-LEN G$;G$
7151 PLOT 0,48: DRAW 255,0
7155 LET BB=U(K,1)+U(K,2)+U(K,3)+U(K,4): LET K$=STR$ (BB): GO SUB 400
7158 PRINT AT 17,3; BRIGHT ON; "Total account      :"; BRIGHT OF; "  "; BRIGHT ON; TAB 30-LEN K$;K$
7159 PLOT 0,20: DRAW 255.0
7160 PRINT AT 20,1; BRIGHT ON; "        Are amounts correct ?        ": GO SUB 900
7170 LET F$=INKEY$
7175 IF F$="Y" AND F$<>"N" THEN GO TO 7170
7180 IF I$="B" AND F$="Y" THEN CLS: GO TO 3302
7182 IF I$="S" AND F$="Y" THEN GO TO 3600
7183 IF I$="5" AND F$="Y" THEN GO TO 10
7198 FOR P=1 TO 4: PRINT AT P+1+P+P,1; FLASH ON; INK ON; P: NEXT P: PRINT AT 20,1; BRIGHT ON; " ENTER Acc.No. you want to alter": INPUT "                    Line No:    "; LINE H$: IF CODE H$<49 OR CODE H$>52 THEN GO TO 7100
7199 LET ALT=VAL H$: PRINT AT 20,1; BRIGHT ON; "        ENTER Correct Amount        ": INPUT "            £  "; U(K,ALT)
7200 GO TO 7100
7220 GO TO 3600
7230 GO TO 10
7300 CLS: LET FA=0: LET CT=0
7302 PRINT AT 0,5; INK 2; BRIGHT ON; "TOTAL INVOICED DUE": PRINT
7310 FOR K=1 TO S1-1
7315 IF U(K,1)+U(K,2)+U(K,3)+U(K,4)=0 THEN NEXT K
7320 LET CT=CT+1: LET BB=U(K,1)+U(K,2)+U(K,3)+U(K,4): LET C$=STR$ (BB): GO SUB 300: PRINT S$(K,1); TAB32-LEN C$;C$: LET FA=FA+BB
7321 IF CT=17 THEN GO SUB 200: CLS: PRINT AT 0,5; INK 2; BRIGHT ON; "TOTAL INVOICED DUE": PRINT: NEXT K
7322 NEXT K
7330 LET C$=STR$ (FA): GO SUB 300
7340 PRINT: PRINT TAB 14; "TOTAL:  "; TAB 32-LEN C$;C$
7350 PRINT: PRINT:  GO SUB 500
7360 LET P$=INKEY$
7365 IF P$="P" THEN GO TO 7300
7370 IF P$="M" THEN GO TO 3000
7375 IF P$<>"M" OR P$<>"P" THEN GO TO 7360
7380 LET FA=0: FOR K=1 S1-1
7381 IF U(K,1)+U(K,2)+U(K,3)+U(K,4)=0 THEN NEXT K
7382 LET BB=U(K,1)+U(K,2)+U(K,3)+U(K,4): LET C$=STR$ (BB): GO SUB 300: LPRINT TAB 4; S$(K,1); TAB 48-LEN c$;C$: LET FA=FA+BB: NEXT K
7384 LET C$=STR$ (FA): GO SUB 300
7386 LPRINT: LPRINT TAB 16; "TOTAL OUTSTANDING:"; TAB 48-LEN C$;C$
7390 GO TO 3000

7400 CLS
7401 PRINT BRIGHT ON; "90 DAYS"
7420 LET FA1=0: LET GT=0: FOR K=1 TO S1-1
7421 IF U(K,1)=0 THEN NEXT K
7422 LET C$=STR$ U(K,1): GO SUB 300
7423 IF U(K,1)>0 THEN PRINT S$(K,1); TAB 32-LEN C$;C$
7424 LET FA1=FA1+U(K,1): NEXT K
7425 LET C$=STR$ (FA1): GO SUB 300
7426 PRINT: PRINT TAB 16; BRIGHT ON; "TOTAL: "; TAB 32-LEN C$;C$
7427 LET GT=GT+FA1: GO SUB 200
7428 CLS: PRINT BRIGHT ON; "60 DAYS"
7429 LET FA2=0: FOR K=1 TO S1-1
7430 IF U(K,2)=0 THEN NEXT K
7431 LET C$=STR$ (U(K,2)): GO SUB 300
7432 IF U(K,2)>0 THEN PRINT S$ (K,1); TAB 32-LEN C$;C$: LET FA2=FA2+U(K,2)
7434 NEXT K
7435 LET C$=STR$ (FA2): GO SUB 300
7436 PRINT: PRINT TAB 16; BRIGHT ON; "TOTAL:"; TAB 32-LEN C$;C$
7437 LET GT=GT+FA2: GO SUB 200: CLS: PRINT BRIGHT ON; "30 DAYS"
7438 LET CT=0: LET FA=0: FOR K=1 TO S1-1
7439 IF U(K,3)=0 THEN NEXT K
7440 LET C$=STR$ (U(K,3)): GO SUB 300
7441 IF U(K,3)>0 THEN PRINT S$(K,1); TAB 32-LEN C$;C$
7442 LET CT=CT+1: LET FA=FA+U(K,3): IF CT=20 THEN GO SUB 200: CLS: PRINT BRIGHT ON; "30 DAYS": NEXT K
7443 NEXT K: LET C$=STR$ (FA): GO SUB 300
7444 PRINT: PRINT TAB 10; BRIGHT ON; "30 DAYS TOTAL:"; TAB 32-LEN C$;C$: GO SUB 200: POKE 23692,255: PRINT:
7445 CLS: LET C$=STR$ (FA1): GO SUB 300: PRINT AT 8,3; BRIGHT ON; "90 DAYS TOTAL:"; TAB 29-LEN C$;C$
7446 LET C$=STR$ (FA): GO SUB 300: PRINT ‘ TAB 3; BRIGHT ON; "30 DAYS TOTAL:"; TAB 29-LEN C$;C$
7457 LET GT=GT+FA: LET C$=STR$ (GT): GO SUB 300
7458 PRINT ‘’’ TAB 3; BRIGHT ON; "GRAND TOTAL    :"; TAB 29-LEN C$;C$
7459 PRINT: PRINT: GO SUB 500
7460 IF P$="P" THEN GO TO 7500
7462 IF P$="M" THEN GO TO 3000
7500 LPRINT TAB 28; "OVERDUE ACCOUNTS": LPRINT TAB 28; "——————————"
7510 LPRINT: LPRINT TAB 8; "OVERDUE 90 DAYS": LPRINT TAB 8; "——————————"
7512 LET FA=0: LET GT=0: FOR K=1 TO S1-1: IF U(K,1)=0 THEN NEXT K
7513 LET C$=STR$ (U(K,1)): GO SUB 300
7514 IF U(K,1)>0 THEN LPRINT TAB 8; S$(K,1); TAB 50-LEN C$;C$
7515 LET FA=FA+U(K,1): NEXT K
7516 LET C$=STR$ (FA): GO SUB 300
7517 LPRINT: LPRINT TAB 34; "TOTAL:"; TAB 50-LEN C$;C$: LPRINT TAB 50-LEN C$; "————"
7520 LPRINT: LPRINT TAB 8; "OVERDUE 60 DAYS": LPRINT TAB 8; "————————-"
7521 LET GT=GT+FA
7522 LET FA=0: FOR K=1 TO S1-1: IF U(K,2)=0 THEN NEXT K
7523 LET C$=STR$ (U(K,2)): GO SUB 300
7524 IF U(K,2)>0 THEN LPRINT TAB 8; S$(K,1); TAB 50-LEN C$;C$
7525 LET FA=FA+U(K,2): NEXT K
7526 LET C$=STR$ (FA): GO SUB 300
7527 LPRINT: LPRINT TAB 34; "TOTAL:"; TAB 50-LEN C$;C$: LPRINT TAB 50-LEN C$; "————"
7530 LPRINT: LPRINT TAB 8; "OVERDUE 30 DAYS": LPRINT TAB8; "——————————"
7531 LET GT=GT+FA
7532 LET FA=0: FOR K=1 TO S1-1: IF U(K,3)=0 THEN NEXT K
7533 LET C$=STR$ (U(K,3)): GO SUB 300
7534 IF U(K,3)>0 THEN LPRINT TAB 8; S$(K,1); TAB 50-LEN C$;C$
7535 LET FA=FA+U(K,3): NEXT K
7536 LET C$=STR$ (FA): GO SUB 300
7537 LPRINT: LPRINT TAB 34; "TOTAL:"; TAB 50-LEN C$;C$: LPRINT TAB 50-LEN C$; "————"
7538 LET GT=GT+FA: LET C$=STR$ (GT): GO SUB 300
7539 LPRINT TAB 28; "GRAND TOTAL:"; TAB 50-LEN C$;C$: LPRINT TAB50-LEN C$; "————"
7999 GO TO 3000
8000 CLS: GO SUB 700: PRINT AT 4,3; BRIGHT ON; INK ON; "*  TRADE PRINTING COMPANY  *"
8010 PRINT AT 10,3; INK 2; INVERSE ON; "  CLEAR INVOICES IN MEMORY  "
8020 PRINT AT 12,8; "This will clear"
8030 PRINT AT 14,5; " * Invoice Numbers. "
8040 PRINT AT 16,5; " * Invoice Dates. "
8050 PRINT AT 18,5; " * Invoices Amounts. "
8060 PRINT AT 21,0; BRIGHT ON; "Press Y to CLEAR or N to return ": GO SUB 920
8070 IF INKEY$="N" THEN GO TO 10
8080 IF INKEY$="Y" THEN PRINT 21,0; BRIGHT ON; "          Y To confirm CLEAR": GO SUB 900
8082 IF INKEY$="N" THEN GO TO 10
8090 CLS: PRINT AT 12,6; BRIGHT ON; INK 4; FLASH ON; "  * CLEARING FILE  * ": BEEP .3,8: BEEP .2,15
8100 LET YT=0
8110 FOR K=1 TO S1-1
8120 LET U(K,1)=U(K,1)+U(K,2): LET U(K,2)=U(K,3): LET U(K,3)=U(K,4): LET U(K,4)=0: NEXT K
8130 LET TAT=1: GO TO 10
8500 PAUSE OF
9399 GO TO 10
9400 LET VAT=0: LET ET1=25: LET STA=65: LET TAT=1: LET IN1=0: LET PER1=15: LET S1=1
9410 GO TO 10
9420 DIM B$(8,ET1)
9430 GO TO 10
9440 DIM E$(2,8)
9450 GO TO 10
9460 DIM S$(70,6,ET1)
9470 GO TO 10
9480 DIM O$(STA,8)
9490 GO TO 10
9500 DIM C(STA,3)
9510 GO TO 10
9512 DIM Q(STA,1)
9515 GO TO 10
9517 DIM U(70,4)
9520 LET CAP=23658
9530 LET M$="                              "
9600 CLS: GO TO 10
9610 CLS: GO SUB 700: PRINT AT 1,3; BRIGHT ON; "*  TRADE PRINTING COMPANY  *": PRINT AT 5,3; " Check that cartridge is"; AT 7,9; "in "; BRIGHT ON; "MICRODRIVE"
9615 PLOT 27,15: DRAW 205,0: DRAW 0,40: DRAW -205,0: DRAW0,-40
9620 PRINT AT 16,6; BRIGHT ON; "Y"; BRIGHT OF; " "; BRIGHT ON; "  To SAVE programme": PRINT AT 18,10; BRIGHT ON; "N"; BRIGHT OF; " "; BRIGHT ON; "  To return "
9630 GO SUB 900
9632 IF INKEY$="Y" THEN PRINT AT 16,12; BRIGHT ON; "  Confirm SAVE  ": GO SUB 900
9640 IF INKEY$<>"Y" THEN GO TO 10
9650 PRINT AT 16,5; INK 2; BRIGHT ON; FLASH ON; "*   SAVING PROGRAMME   *"
9660 PRINT AT 18,7; INK 2; BRIGHT ON; FLASH ON; "*   DO NOT TOUCH   *"
9665 PRINT AT1,0; M$
9670 BEEP .1,5: ERASE "m";1;"run"
9690 SAVE *"m";1;"run" LINE 1
9710 VERIFY *"m";1;"run"
9720 PRINT AT 16,4; INK 4; BRIGHT ON; "*  PROGRAMME NOW SAVED  *": PRINT AT 18,7; "                         "
9730 BEEP .2,15: BEEP .2,8: PAUSE 80: GO TO 10
9800 LET STK=PEEK 23653+256*(PEEK 23654): LET RMT=PEEK 23730+256*(PEEK 23751)
9801 LET MEM=RMT-STK: PRINT ‘’’ " MEMORY REMAINING:  ";MEM; ". BYTES"
9802 PAUSE 0: GO TO 10